# ê³ ì°¨ í•¨ìˆ˜: íŒŒë¼ë¯¸í„°ì™€ ë°˜í™˜ ê°’ìœ¼ë¡œ ëŒë‹¤ ì‚¬ìš©
## 1. ê³ ì°¨ í•¨ìˆ˜ ì •ì˜
- ê³ ì°¨ í•¨ìˆ˜ëŠ” ë‹¤ë¥¸ í•¨ìˆ˜ë¥¼ ì¸ìë¡œ ë°›ê±°ë‚˜ í•¨ìˆ˜ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë‹¤.
### ğŸ“Œ í•¨ìˆ˜ íƒ€ì…
- í•¨ìˆ˜ íƒ€ì…ì„ ì •ì˜í•˜ë ¤ë©´ í•¨ìˆ˜ íŒŒë¼ë¯¸í„°ì˜ íƒ€ì…ì„ ê´„í˜¸ ì•ˆì— ë„£ê³ , ê·¸ ë’¤ì— í™”ì‚´í‘œ(â†’)ë¥¼ ì¶”ê°€í•œ ë‹¤ìŒ, í•¨ìˆ˜ì˜ ë°˜í™˜ íƒ€ì…ì„ ì§€ì •í•˜ë©´ ëœë‹¤.
- í•¨ìˆ˜ íƒ€ì…ì—ì„œë„ ë°˜í™˜ íƒ€ì…ì„ ë„ì´ ë  ìˆ˜ ìˆëŠ” íƒ€ì…ìœ¼ë¡œ ì €ì •í•  ìˆ˜ ìˆë‹¤.
- í•¨ìˆ˜ì˜ íƒ€ì…ì´ ì•„ë‹ˆë¼ í•¨ìˆ˜ íƒ€ì… ì „ì²´ê°€ ë„ì´ ë  ìˆ˜ ìˆëŠ” íƒ€ì…ì„ì„ ì„ ì–´í•˜ê¸° ìœ„í•´ í•¨ìˆ˜ íƒ€ì…ì„ ê´„í˜¸ë¡œ ê°ì‹¸ê³  ê·¸ ë’¤ì— ë¬¼ìŒí‘œë¥¼ ë¶™ì—¬ì•¼ë§Œ í•œë‹¤.
```kotlin
var canReturnNull: (Int, Int) -> Int? = {x, y -> null}
var funOrNull: ((Int, Int) -> Int) ? null
```

### ğŸ“Œ ì¸ìë¡œ ë°›ì€ í•¨ìˆ˜ í˜¸ì¶œ
```kotlin
fun twoAndThree(operation: (Int, Int) -> Int) {
    val result = operation(2, 3)
    println("The result is $result")
}

twoAndThree { a, b -> a + b } // The result is 5
twoAndThree { a, b -> a * b } // The result is 6
```
- ì¸ìë¡œ ë°›ì€ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” êµ¬ë¬¸ì€ ì¼ë°˜ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” êµ¬ë¬¸ê³¼ ê°™ë‹¤.
- í•¨ìˆ˜ ì´ë¦„ ë’¤ì— ê´„í˜¸ë¥¼ ë¶™ì´ê³  ê´„í˜¸ ì•ˆì— ì›í•˜ëŠ” ì¸ìë¥¼ ì½¤ë§ˆ(,)ë¡œ êµ¬ë¶„í•´ ë„£ëŠ”ë‹¤
- Stringì— ëŒ€í•œ filterë¥¼ êµ¬í˜„
- ë¬¸ìì—´ì˜ ê° ë¬¸ìë¥¼ ìˆ ì–´ì— ë„˜ê²¨ì„œ ë°˜í™˜ ê°’ì´ trueë©´ ê²°ê³¼ë¥¼ ë‹´ëŠ” StringBuilderë’¤ì— ê·¸ ë¬¸ìë¥¼ ì¶”ê°€í•œë‹¤.
```kotlin
fun String.filter(predicate: (Char) -> Boolean): String {
    val sb = StringBuilder()
    for (index in 0 until length) {
        val element = get(index)
        if (predicate(element)) sb.append(element)
    }
    return sb.toString()
}

println("ab1c".filter { it in 'a'..'z' }) //abc
```


### ğŸ“Œ ìë°”ì—ì„œ ì½”í‹€ë¦° í•¨ìˆ˜ íƒ€ì… ì‚¬ìš©
- ì»´íŒŒì¼ëœ ì½”ë“œ ì•ˆì—ì„œ í•¨ìˆ˜ íƒ€ì…ì€ ì¼ë°˜ ì¸í„°í˜ì´ìŠ¤ë¡œ ë°”ë€ë‹¤.
- í•¨ìˆ˜ íƒ€ì…ì˜ ë³€ìˆ˜ëŠ” FunctionN ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” ê°ì²´ë¥¼ ì €ì¥í•œë‹¤.
- ì½”í‹€ë¦° í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” í•¨ìˆ˜ ì¸ìì˜ ê°œìˆ˜ì— ë”°ë¼ Function0(ì¸ìê°€ ì—†ëŠ” í•¨ìˆ˜), Function1<P1, R>(ì¸ìê°€ í•˜ë‚˜ì¸ í•¨ìˆ˜) ë“±ì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µ


### ğŸ“Œ ë””í´íŠ¸ ê°’ì„ ì§€ì •í•œ í•¨ìˆ˜ íƒ€ì… íŒŒë¼ë¯¸í„°ë‚˜ ë„ì´ ë  ìˆ˜ ìˆëŠ” í•¨ìˆ˜ íƒ€ì… íŒŒë¼ë¯¸í„°
- íŒŒë¼ë¯¸í„°ë¥¼ í•¨ìˆ˜ íƒ€ì…ìœ¼ë¡œ ì„ ì–¸í•  ë•Œë„ ë””í´íŠ¸ ê°’ì„ ì •í•  ìˆ˜ ìˆë‹¤.
```kotlin
fun <T> Collection<T>.joinToString(
    separator: String = ", ",
    prefix: String = "",
    postfix: String = "",
    transform: (T) -> String = { it.toString() } // í•¨ìˆ˜ íƒ€ì… íŒŒë¼ë¯¸í„°ë¥¼ ì„ ì–¸í•˜ë©´ì„œ ëŒë‹¤ë¥¼ ë””í´íŠ¸ ê°’ìœ¼ë¡œ ì§€ì •í•œë‹¤. 
): String {
    val result = StringBuilder(prefix)

    for ((index, element) in this.withIndex()) {
        if (index > 0) result.append(separator)
        result.append(transform(element)) // "transform" íŒŒë¼ë¯¸í„°ë¡œ ë°›ì€ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤. 
    }

    result.append(postfix)
    return result.toString()
}

val letters = listOf("Alpha", "Beta")
println(letters.joinToString()) // ë””í´íŠ¸ ë³€í™˜ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤. -> Alpha, Beta
println(letters.joinToString { it.toLowerCase() }) // ëŒë‹¤ë¥¼ ì¸ìë¡œ ì „ë‹¬í•œë‹¤. -> alpha, beta
println(letters.joinToString(separator = "! ", postfix = "! ",
    transform = { it.toUpperCase() })) // ì´ë¦„ ë¶™ì€ ì¸ì êµ¬ë¬¸ì„ ì‚¬ìš©í•´ ëŒë‹¤ë¥¼ í¬í•¨í•˜ëŠ” ì—¬ëŸ¬ ì¸ìë¥¼ ì „ë‹¬í•œë‹¤. -> ALPHA! BETA!
```


### ğŸ“Œ í•¨ìˆ˜ë¥¼ í•¨ìˆ˜ì—ì„œ ë°˜í™˜
```kotlin
// í•¨ìˆ˜ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ ì •ì˜
enum class Delivery { STANDARD, EXPEDITED }

class Order(val itemCount: Int)

fun getShippingCostCalculator(
        delivery: Delivery): (Order) -> Double { // í•¨ìˆ˜ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì„ ì–¸í•œë‹¤.
    if (delivery == Delivery.EXPEDITED) {
        return { order -> 6 + 2.1 * order.itemCount } //í•¨ìˆ˜ì—ì„œ ëŒë‹¤ë¥¼ ë°˜í™˜í•œë‹¤.
    }

    return { order -> 1.2 * order.itemCount } //í•¨ìˆ˜ì—ì„œ ëŒë‹¤ë¥¼ ë°˜í™˜í•œë‹¤.
}

val calculator = getShippingCostCalculator(Delivery.EXPEDITED) // ë°˜í™˜ë°›ì€ í•¨ìˆ˜ë¥¼ ë³€ìˆ˜ì— ì €ì¥í•œë‹¤.
println("Shipping costs ${calculator(Order(3))}") // Shipping costs 12.3
```
- `getShippingCostCalculator` í•¨ìˆ˜ëŠ” `Order`ë¥¼ ë°›ì•„ì„œ Doubleì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë°˜í™˜í•œë‹¤.
- í•¨ìˆ˜ë¥¼ ë°˜í™˜í•˜ë ¤ë©´ return ì‹ì— ëŒë‹¤ë‚˜ ë©¤ë²„ ì°¸ì¡°ë‚˜ í•¨ìˆ˜ íƒ€ì…ì˜ ê°’ì„ ê³„ì‚°í•˜ëŠ” ì‹ ë“±ì„ ë„£ìœ¼ë©´ ëœë‹¤.

### ğŸ“Œ ëŒë‹¤ë¥¼ í™œìš©í•œ ì¤‘ë³µ ì œê±°
- í•¨ìˆ˜ íƒ€ì…ê³¼ ëŒë‹¤ ì‹ì€ ì¬í™œìš©í•˜ê¸° ì¢‹ì€ ì½”ë“œë¥¼ ë§Œë“¤ ë•Œ ì“¸ ìˆ˜ ìˆëŠ” í›Œë¥­í•œ ë„êµ¬ë‹¤.
```kotlin
data class SiteVisit(
    val path: String,
    val duration: Double,
    val os: OS
)

enum class OS { WINDOWS, LINUX, MAC, IOS, ANDROID }

val log = listOf(
    SiteVisit("/", 34.0, OS.WINDOWS),
    SiteVisit("/", 22.0, OS.MAC),
    SiteVisit("/login", 12.0, OS.WINDOWS),
    SiteVisit("/signup", 8.0, OS.IOS),
    SiteVisit("/", 16.3, OS.ANDROID)
)

val averageWindowsDuration = log
    .filter { it.os == OS.WINDOWS }
    .map(SiteVisit::duration)
    .average()

fun List<SiteVisit>.averageDurationFor(os: OS) =
    filter { it.os == os }.map(SiteVisit::duration).average()

println(log.averageDurationFor(OS.WINDOWS)) // 23.0
println(log.averageDurationFor(OS.MAC))  // 22.0
```

```kotlin
//ê³ ì°¨ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ì¤‘ë³µ ì œê±°í•˜ê¸°
fun List<SiteVisit>.averageDurationFor(predicate: (SiteVisit) -> Boolean) =
        filter(predicate).map(SiteVisit::duration).average()

println(log.averageDurationFor {
    it.os in setOf(OS.ANDROID, OS.IOS) }) // 12.15
println(log.averageDurationFor {
    it.os == OS.IOS && it.path == "/signup" }) // 8.0
```

## 2. ì¸ë¼ì¸ í•¨ìˆ˜: ëŒë‹¤ì˜ ë¶€ê°€ ë¹„ìš© ì—†ì• ê¸°
-  inline ë³€ê²½ìë¥¼ ì–´ë–¤ í•¨ìˆ˜ì— ë¶™ì´ë©´ ì»´íŒŒì¼ëŸ¬ëŠ” ê·¸ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ëª¨ë“  ë¬¸ì¥ì„ í•¨ìˆ˜ ë³¸ë¬¸ì— í•´ë‹¹í•˜ëŠ” ë°”ì´íŠ¸ì½”ë“œë¡œ ë°”ê¿”ì¹˜ê¸° í•´ì¤€ë‹¤.
### ğŸ“Œ ì¸ë¼ì´ë‹ì´ ì‘ë™í•˜ëŠ” ë°©ì‹
- í•¨ìˆ˜ë¥¼ inlineìœ¼ë¡œ ì„ ì–¸í•˜ë©´ ê·¸ í•¨ìˆ˜ì˜ ë³¸ë¬¸ì´ ì¸ë¼ì¸ëœë‹¤.
- í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ì½”ë“œë¥¼ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ë°”ì´íŠ¸ì½”ë“œ ëŒ€ì‹ ì— í•¨ìˆ˜ ë³¸ë¬¸ì„ ë²ˆì—­í•œ ë°”ì´íŠ¸ ì½”ë“œë¡œ ì»´íŒŒì¼í•œë‹¤ëŠ” ëœ»ì´ë‹¤.
```kotlin
inline fun <T> synchronized(lock: Lock, action: () -> T): T {
	lock.lock()
    try {
		return action()
	}
	finally {
		lock.unlock()
	}
}

val l = Lock()

synchronized(l) {
	// ... 	
}
```
- synchronized í•¨ìˆ˜ë¥¼ inlineìœ¼ë¡œ ì„ ì–¸í–ˆìœ¼ë¯€ë¡œ synchronized ë¥¼ í˜¸ì¶œí•˜ëŠ” ì½”ë“œëŠ” ëª¨ë‘ ìë°”ì˜ synchronized ë¬¸ê³¼ ê°™ì•„ì§„ë‹¤.

## 3. ê³ ì°¨ í•¨ìˆ˜ ì•ˆì—ì„œ íë¦„ ì œì–´
### ğŸ“Œ ëŒë‹¤ì•ˆì˜ returnë¬¸: ëŒë‹¤ë¥¼ ë‘˜ëŸ¬ì‹¼ í•¨ìˆ˜ë¡œë¶€í„° ë°˜í™˜
- ë‹¤ìŒ ì½”ë“œì˜ ì‹¤í–‰ ê²°ê³¼ë¥¼ ë³´ë©´ ì´ë¦„ì´ Aliceì¸ ê²½ìš°ì— lookForAlice í•¨ìˆ˜ë¡œë¶€í„° ë°˜í™˜ëœë‹¤.
```kotlin
data class Person(val name: String, val age: Int)

val people = listOf(Person("Alice", 29), Person("Bob", 31))

fun lookForAlice(people: List<Person>) {
    for (person in people) {
        if (person.name == "Alice") {
            println("Found!")
            return
        }
    }
    println("Alice is not found")
}
```
- forEach í•¨ìˆ˜ë¥¼ ëŒ€ì‹  ì¨ë„ ì•ˆì „í•˜ë‹¤.
```kotlin
fun lookForAlice(people: List<Person>) {
    people.forEach {
        if (it.name == "Alice") {
            println("Found!")
            return
        }
    }
    println("Alice is not found")
}
```
- ëŒë‹¤ ì•ˆì—ì„œ returnì„ ì‚¬ìš©í•˜ë©´ ëŒë‹¤ë¡œë¶€í„°ë§Œ ë°˜í™˜ë˜ëŠ” ê²Œ ì•„ë‹ˆë¼ ê·¸ ëŒë‹¤ë¥¼ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ê°€ ì‹¤í–‰ì„ ëë‚´ê³  ë°˜í™˜ëœë‹¤.
- ìì‹ ì„ ë‘˜ëŸ¬ì‹¸ê³  ìˆëŠ” ë¸”ë¡ë³´ë‹¤ ë” ë°”ê¹¥ì— ìˆëŠ” ë‹¤ë¥¸ ë¸”ë¡ì„ ë°˜í™˜í•˜ê²Œ ë§Œë“œëŠ” return ë¬¸ì„ ë„Œë¡œì»¬(non-local) returnì´ë¼ ë¶€ë¥¸ë‹¤.
- returnì´ ë°”ê¹¥ìª½ í•¨ìˆ˜ë¥¼ ë°˜í™˜ì‹œí‚¬ ìˆ˜ ìˆëŠ” ë•ŒëŠ” ëŒë‹¤ë¥¼ ì¸ìë¡œ ë°›ëŠ” í•¨ìˆ˜ê°€ ì¸ë¼ì¸ í•¨ìˆ˜ì¸ ê²½ìš°ë¿ì´ë‹¤.


### ğŸ“Œ ëŒë‹¤ë¡œë¶€í„° ë°˜í™˜: ë ˆì´ë¸”ì„ ì‚¬ìš©í•œ return
- ëŒë‹¤ ì‹ì—ì„œë„ ë¡œì»¬ returnì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ëŒë‹¤ ì•ˆì—ì„œ ë¡œì»¬ returnì€ forë£¨í”„ì˜ breakì™€ ë¹„ìŠ·í•œ ì—­í• ì„ í•œë‹¤.
- ë¡œì»¬ returnê³¼ ë„Œë¡œì»¬ returnì„ êµ¬ë¶„í•˜ê¸° ìœ„í•´ ë ˆì´ë¸”(label)ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
```kotlin
//ë ˆì´ë¸”ì„ í†µí•´ ë¡œì»¬ ë¦¬í„´ ì‚¬ìš©í•˜ê¸°
fun lookForAlice(people: List<Person>) {
    people.forEach label@{ //ëŒë‹¤ì‹ ì•ì— ë ˆì´ë¸”ì„ ë¶™ì¸ë‹¤.
        if (it.name == "Alice") return@label //return@labelì€ ì•ì—ì„œ ì •ì˜í•œ ë ˆì´ë¸”ì„ ì°¸ì¡°í•œë‹¤.
    }
    println("Alice might be somewhere") //í•­ìƒ ì´ì¤„ì´ ì¶œë ¥ëœë‹¤.
}
```
- ëŒë‹¤ì— ë ˆì´ë¸”ì„ ë¶™ì—¬ì„œ ì‚¬ìš©í•˜ëŠ” ëŒ€ì‹  ëŒë‹¤ë¥¼ ì¸ìë¡œ ë°›ëŠ” ì¸ë¼ì¸ í•¨ìˆ˜ì˜ ì´ë¦„ì„ return ë’¤ì— ë ˆì´ë¸”ë¡œ ì‚¬ìš©í•´ë„ ëœë‹¤.
```kotlin
fun lookForAlice(people: List<Person>) {
    people.forEach {
        if (it.name == "Alice") return@forEach
    }
    println("Alice might be somewhere")
}
```
- ëŒë‹¤ ì‹ì˜ ë ˆì´ë¸”ì„ ëª…ì‹œí•˜ë©´ í•¨ìˆ˜ ì´ë¦„ì„ ë ˆì´ë¸”ë¡œ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.


### ğŸ“Œ ë¬´ëª… í•¨ìˆ˜: ê¸°ë³¸ì ìœ¼ë¡œ ë¡œì»¬ return
- ë¬´ëª… í•¨ìˆ˜ëŠ” ì½”ë“œ ë¸”ë¡ì„ í•¨ìˆ˜ì— ë„˜ê¸¸ ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë‹¤ë¥¸ ë°©ë²•ì´ë‹¤.
```kotlin
fun lookForAlice(people: List<Person>) {
    people.forEach(fun (person) { //ëŒë‹¤ ì‹ ëŒ€ì‹  ë¬´ëª… í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤.
        if (person.name == "Alice") return // return ì€ ê°€ì¥ ê°€ê¹Œìš´ í•¨ìˆ˜ë¥¼ ê°€ë¥´í‚¤ëŠ”ë° ì´ ìœ„ì¹˜ì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ í•¨ìˆ˜ëŠ” ë¬´ëª… í•¨ìˆ˜ë‹¤. 
        println("${person.name} is not Alice")
    })
}
```





